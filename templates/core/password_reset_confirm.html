{% extends 'core/base_client_auth.html' %}
{% load static %}

{% block title %}Set New Password{% endblock %}

{% block card_content %}
<h4 class="auth-title text-center  mb-3">Set a New Password</h4>
<p class="text-muted text-center mb-4">Please enter your new password twice.</p>

{% if validlink %}
    <form class="form-horizontal" method="POST">
        {% csrf_token %}

        {% if form.errors %}
            <div class="alert alert-danger" role="alert">
                <strong>Errors:</strong>
                <ul class="mb-0">
                {% for field, errors in form.errors.items %}
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
                </ul>
            </div>
        {% endif %}

        <div class="mb-3">
            <label for="{{ form.new_password1.id_for_label }}" class="form-label">New Password</label>
            <input type="password" name="{{ form.new_password1.name }}" class="form-control" id="{{ form.new_password1.id_for_label }}" required>
        </div>

        <div class="mb-3">
            <label for="{{ form.new_password2.id_for_label }}" class="form-label">Confirm New Password</label>
            <input type="password" name="{{ form.new_password2.name }}" class="form-control" id="{{ form.new_password2.id_for_label }}" required>
        </div>
        
        <div class="mt-4 d-grid">
            <button class="btn btn-primary waves-effect waves-light" type="submit">Change Password</button>
        </div>
    </form>
{% else %}
    <div class="alert alert-danger text-center">
        This password reset link is invalid or has expired. Please try resetting your password again.
    </div>
    <div class="d-grid">
         <a href="{% url 'core:password_reset' %}" class="btn btn-primary">Request a New Link</a>
    </div>
{% endif %}
{% endblock %}